### 概要
- LvLiNGAMを提案.
- LvLiNGAMは隠れ変数(未観測共通原因)が存在していても因果推論が可能なモデル.
  - 混合行列に線形性を仮定.
  - 外生変数の分布に非ガウスを仮定.
- 数値シミュレーションを行い, コードも公開している.

### 2 Two observed variables
#### 2.3 Exploiting non-Gaussianity
忠実性を仮定すると, 行列Aさえ推定できれば6つのモデルは識別可能. Aに関してはICAの理論を適用することができる. 共通原因がない場合は独立変数の数と観測変数の数が同じであり, ‘easy case’である. 共通原因がある場合は’overcomplete basis’ ICA(不完全基底ICA)の困難なケースである. ただし, 行列Aは十分なデータがあれば識別可能であることが証明されている. (実用的な推定方法については4章で議論している.)

![151_01](https://github.com/wataoka/papersheet2md/blob/main/images/151_01.png?raw=true)

共通原因が複数ある場合について
共通原因が複数あったとしても, 因果グラフの構造は正しく識別することができる.
しかし, パラメータに関しては, 共通原因がN_hあるとすると, N_h + 1通りの異なる解が存在する. 理由としては外生変数の割り当て, 交絡因子の割り当ての選択に起因している.

### 3 The general case
#### 3.2 Canonical models
Figure2(a)のx7
観測変数から影響を受けていて, 誰にも影響を与えないような潜在変数は検知不可能であるが, 「観測変数間の因果関係を明らかにしたい」という目的の上では検知する必要がないので問題ではない.

Figure2(b)のx6
観測変数→x6→潜在変数というようなx6は観測変数→潜在変数という風に書き下すことができるので, 探索した結果そのような書き下した結果が得られる. Figure2(b)

Canonical model (正準モデル)の定義:
以下を満たすlatent variables LiNGAMモデル
- 潜在変数はrootノード(親を持たない)
- 潜在変数は少なくとも2つの子をもつ
- 潜在変数は平均0で分散1
- 異なる2つの潜在変数が同じ子集合を持つことはOKだが, 観測変数への影響度の大きさが同じ比率になってはいけない

任意のlatent variable LiNGAMモデルを入力とし, それのCanonical modelを出力するアルゴリズムも提案している. Algorithm A

#### 3.3 Model estimation in the Gaussian framework
この節では, related worksのように関連する話題を出している.

外生変数にGaussを仮定した場合
- 潜在変数がないとわかっていて, 変数の時間順序がわかっているときは簡単だよ.
- 潜在変数がないとわかっていて, 変数の時間順序がわかっていないと一意に推定できないよ.
- 潜在変数がないとわからない時, FCIのようにデータを生成した可能性のある忠実な因果モデルセットを出力するアルゴリズムはあるが, 条件付き独立だけに基づいているため, 出力できる情報量がかなり制限されている. 

非ガウス性を利用することでモデルを区別する能力を大幅に向上できるのに...という話

#### 3.4 Model estimation based on non-Gaussianity
任意の忠実なlatent variable LiNGAMモデルによって生成されたデータから生成モデルと観測的に等価な正準モデルのセットを推定する方法を示す.

x~をfull data vectorとする.
変数を中心化すると, 次のように書ける.
$\hat{x}$ = $\hat{B}$$\hat{x}$ + e
	(DAGの過程をおいているので)
また, 因果順序k(i)を知っているなら, $\hat{B}$は厳密な下三角行列に並び替えることができる.

$\hat{x}$について解くと,

```math
	\hat{x} = \hat{A}e
	\hat{A} = (I - \hat{B})^{-1}
```

となる.
A~もまた(厳密ではないが)下三角行列に並び替えることができる.
これは標準線形ICAの枠組みで解くことができる.
(線形, 非ガウス, 独立などの仮定があるから)

観測変数の数が独立変数の数より少ないとき,overcomplete basis in the ICAの枠組みとなる.


#### Algorithm B:
overcomplete basis Aと観測された変数の平均が与えられた時, 基底と互換性のある全ての観測的に等価な正準latent variable LiNGAMモデルを計算する.

- NhはAの列数から行数から引いたもの.
- Aの列それぞれを観測変数の外生変数と潜在変数の外生変数に属するものとして分類する.
  - 潜在変数として選択されたものが最初に来るようにAを並び替える.
  - 行列Aの上部にfig3aのようにゼロを拡張されることで, 推定行列$\hat{A}$を得る.
  - $\hat{A}$をlower三角形に並び替えできるかどうかを検定する. できなければ次の分類に進む. (for文でいうcontinue)
  - $\hat{B}$ (=I-$\hat{A}~{-1}$)を計算する.
  - Bのネットワークが忠実性の仮定に適合していることを確認する. そうでない場合は次の分類に進む. (for文でいうcontinue)
  - データを生成した可能性のある観測的に等価なモデルのリストに$\hat{B}$を追加する.

### wataokaのコメント
未観測共通原因を扱う因果探索はLvLiNGAMの他のも多く存在しているが, 未観測共通原因の値まで推定する手法はほとんど存在しない.  OvercompleteICAの枠組みに落とし込んだ後, 行列の推定のためにEMアルゴリズムを用いることがあるが, 非常に計算量が高いため, 高次元では使い物にならない. 2019年にLFOICAというディープラーニングを用いた手法が提案されているので, そちらを用いればなんとかいける.
